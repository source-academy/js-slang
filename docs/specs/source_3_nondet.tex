\input source_header.tex

\begin{document}
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	\docheader{2021}{Source}{\S 3 Non-Det}{Martin Henz, Arsalan Cheema, Anubhav}
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input source_intro.tex

Source \S 3 Non-Det is a nondeterministic variant of Source \S 3.

\section{Changes}

Source \S 3 Non-Det modifies Source \S 3 by adding an automatic search mechanism into the language semantics. The language allows programmers to specify \emph{choices} and \emph{requirements}. At runtime, the search mechanism automatically resolves these requirements, and identifies all those choices that satisfy them. \newline

This is achieved by supporting a new type of expression, called the \emph{choice point} expression. Every choice point expression is described by a (possibly empty) set of \emph{expressions} (known as the set of \emph{choices}). At runtime, a choice point expression can assume any value from its set of choices. A program can also include instructions that force the language processor to \emph{backtrack} to any choice point expression. \emph{Backtracking} means that the choice point expression will take on a different value from its set of choices, and the program will then be re-evaluated with this new choice. \newline

A Source \S 3 Non-Det program can contain any number of choice points. Evaluating a program can hence have an exponential number of outcomes - one outcome for every combination of possible choices. The language's search mechanism, however, only returns one outcome at a time. The programmer can \emph{command} the search mechanism to re-evaluate the program with a different combination of choices. On the Source Academy Playground, this command is implemented as the magic phrase \verb#try_again#,
which has to be entered into the REPL. \newline

In the Source Academy implementation, the Source \S 3 Non-Det evaluator can only process one program at a time. If the evaluator is given a new program \textbf{before} all the outcomes of an existing program have been processed, then all remaining outcomes will be ignored. \newline

Unlike the implementations of Source \S 3,  the implementation of Source \S 3 Non-Det does not use a constant amount of memory for loops. Instead, memory usage increases linearly with the number of iterations. This is because each iteration can be nondeterministic. Each iteration's state must be kept in memory so that the language processor can backtrack to every iteration. Similarly, no tail call optimization is done, because every function application's state must be kept in memory to allow backtracking.

Source \S 3 Non-Det currently does not support import directives.

\input source_bnf.tex

\newpage

\input source_3_bnf_without_import.tex

\newpage

\input source_return

\input source_import

\input source_boolean_operators

\input source_loops

\input source_names_lang

\input source_numbers

\input source_strings

\input source_arrays

\input source_comments

\input source_typing_3

\section{Standard Libraries}

The following libraries are always available in this language.

\input source_misc

\input source_math

\input source_nondet

\input source_lists

\input source_pair_mutators

\input source_array_support

\input source_streams

\input source_js_differences

\newpage

\input source_list_library

\newpage

\input source_stream_library

\newpage

\input source_nondet_library

    \end{document}
